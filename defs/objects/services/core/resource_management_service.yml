name: resource_management

docstring: |
  The Resource Management Service is the service that manages the Resource Types and Lifecycles
  workflows associated with Resource Types.  It also provides operations that manage any kind of
  resource, their lifecycle. The service also proces a resource agent interface to any resource,
  configured by resource type.

spec: https://confluence.oceanobservatories.org/display/syseng/CIAD+COI+OV+Resource+Management+Service

dependencies: [resource_registry]

methods:

  # -----------------
  # Generic resource CRUD interface for any resource

  create_resource:
    docstring: |
      Creates an arbitrary resource object via its defined create function, so that it
      can successively can be accessed via the agent interface.
    in:
      resource: !Resource
    out:
      resource_id: ""
    throws:
      BadRequest: if object passed has _id or _rev attribute

  update_resource:
    docstring: Updates an existing resource via the configured service operation.
    in:
      resource: !Resource
    out:
    throws:
      BadRequest: if object does not have _id or _rev attribute
      NotFound: object with specified id does not exist
      Conflict: object not based on latest persisted object version

  read_resource:
    docstring: Returns an existing resource via the configured service operation.
    in:
      resource_id: ""
    out:
      resource: !Resource
    throws:
      NotFound: object with specified id does not exist

  delete_resource:
    docstring: Deletes an existing resource via the configured service operation.
    in:
      resource_id: ""
    out:
    throws:
      NotFound: object with specified id does not exist


  # -----------------
  # Other common resource operations for any resource

  execute_lifecycle_transition:
    docstring: |
      Alter object lifecycle according to given transition event. Throws exception
      if resource object does not exist or given transition_event is unknown/illegal.
      The new life cycle state after applying the transition is returned.
    in:
      resource_id: ""
      transition_event: ""
    out:
      lcstate: ""
    throws:
      NotFound: resource object does not exist
      BadRequest: transition event unknown or illegal in current state; resource type has no lifecycle
      Conflict: race condition while trying to update

  get_lifecycle_events:
    docstring: |
      For a given resource, return a list of possible lifecycle transition events.
    in:
      resource_id: ""
    out:
      transition_events: []
    throws:
      NotFound: resource object does not exist
      BadRequest: transition event unknown or illegal in current state; resource type has no lifecycle
